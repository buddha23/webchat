<link rel="stylesheet" href="scripts/components/zTree/css/ztree.css">
<link rel="stylesheet" href="scripts/components/zTree/css/metroStyle/metroStyle.css">
<style type="text/css">
    #nodeForm {
        display: none;
        padding: 20px 30px 0;
        width: 680px;
    }

    #nodeForm p input {
        margin-left: 10px;
        width: 530px;
    }
</style>

<div class="am-cf am-padding">
    <div class="am-fl am-cf">
        <strong class="am-text-primary am-text-lg">视频课程管理</strong> /
        <small>视频课程详情</small>
    </div>
</div>

<div class="am-g" ng-controller="volumeDetailCtrl">
    <form class="am-form" name="volumeForm">
        <div class="am-u-lg-6 am-u-md-12">
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    课程分类
                </div>
                <div class="am-u-md-4 am-u-lg-4">
                    <select ng-model="c1" ng-options="f.name for f in c1s"></select>
                </div>
                <div class="am-u-md-4 am-u-lg-4">
                    <select ng-model="volume.caterogyId" ng-options="c.id as c.name for c in c1.children" required></select>
                </div>
                <div class="am-u-lg-2 am-u-lg-only">*必选</div>
            </div>
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    课程标题
                </div>
                <div class="am-u-md-8 am-u-lg-4">
                    <input type="text" class="am-input-sm" ng-model="volume.name" required>
                </div>
                <div class="am-hide-sm-only am-u-md-6">*必填，不可重复</div>
            </div>
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    课程标签
                </div>
                <div class="am-u-md-8 am-u-lg-10 am-btn-group" data-am-button>
                    <label ng-repeat="t in allTag" class="{{checkClass(t.id)}}">
                        <input type="checkbox" name="vod-tag" value="{{t.id}}" ng-checked="isSelected({{t.id}})">{{t.name}}
                    </label>
                </div>
                <!--<button ng-click="queding()">确定</button>-->
            </div>
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    所需牛人币
                </div>
                <div class="am-u-md-8 am-u-lg-4">
                    <input type="number" class="am-input-sm" ng-model="volume.costScore" value="0" min="0" required>
                </div>
                <div class="am-hide-sm-only am-u-md-6">*必填</div>
            </div>
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    主讲人
                </div>
                <div class="am-u-md-8 am-u-lg-4">
                    <input type="text" class="am-input-sm" ng-model="volume.lecturer" required>
                </div>
                <div class="am-hide-sm-only am-u-md-6">*必填</div>
            </div>
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    排序
                </div>
                <div class="am-u-md-8 am-u-lg-4">
                    <input type="number" class="am-input-sm" ng-model="volume.sorting" required>
                </div>
                <div class="am-hide-sm-only am-u-md-6">*必填(值越小排名越前)</div>
            </div>

            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    课程讲师
                </div>
                <div class="am-u-md-8 am-u-lg-4">
                    <select class="am-input-sm" ng-model="volume.lecturerId">
                        <option value="0" ng-selected="0 == volume.lecturerId">无</option>
                        <option ng-repeat="l in allLecturer" value="{{l.id}}" ng-selected="l.id == volume.lecturerId">{{l.name || l.nickname}}</option>
                    </select>
                </div>
                <div class="am-hide-sm-only am-u-md-6">*非必填(收入将按比例分给讲师)</div>
            </div>
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    讲师分成
                </div>
                <div class="am-u-md-8 am-u-lg-3">
                    <input id="fencheng" type="number" class="am-input-sm" ng-model="volume.lecturerProfit" min="0" max="100">
                </div>
                <div class="am-u-md-8 am-u-lg-1">
                    <label class="am-input-sm" for="fencheng">%</label>
                </div>
                <div class="am-hide-sm-only am-u-md-6">*非必填(收入将按比例分给讲师)</div>
            </div>
        </div>
        <div class="am-u-lg-6 am-u-md-12">
            <div class="am-g am-margin-top">
                <div class="am-u-md-4 am-u-lg-2 am-text-right">
                    <label for="icon">视频封面：</label>
                </div>
                <div class="am-u-md-8 am-u-lg-4">
                    <label for="icon">
                        <img id="iconImg" ng-src="{{volume.cover ? '/files/' + volume.cover : 'assets/images/add_img_btn.png'}}" class="am-img-thumbnail am-img-bdrs" alt="点击上传">
                    </label>
                    <input id="icon" type="file" style="display:none" ng-file="t.file" fileChange="fileChanged(ngFile)">
                    <input type="hidden" id="volumeCover" ng-model="volume.cover">
                </div>
                <div class="am-hide-md am-u-lg-6">点击图片上传图标，大小不能超过1M</div>
            </div>
        </div>
        <div class="am-u-md-12 am-margin-top">
            <section class="am-panel am-panel-default">
                <header class="am-panel-hd">
                    <h3 class="am-panel-title">课程说明</h3>
                </header>
                <div class="am-panel-bd">
                    <div class="am-form-group">
                        <label for="editor">课程介绍</label>
                        <script type="text/plain" id="editor" style="width:100%;height:360px;"></script>
                        <!--<textarea rows="3" id="doc-ta-1" ng-model="volume.introduction"></textarea>-->
                    </div>
                    <div class="am-form-group">
                        <label for="doc-ta-2">课程内容</label>
                        <textarea rows="5" id="doc-ta-2" ng-model="volume.content"></textarea>
                    </div>
                    <div class="am-g">
                        <div class="am-u-lg-6 am-u-md-12">
                            <h3>课程章节</h3>
                            <div class="am-u-lg-2 am-u-md-12">编辑说明：</div>
                            <div class="am-u-lg-10 am-u-md-12">
                                <p>
                                    1、章节可以自由拖动，但章不可包含章；<br>
                                    2、章拖动，所属小节随之拖动；<br>
                                    3、待处理视频列表中的对象可以自由拖动到任何章；<br>
                                    4、鼠标移动到章节名称可以显示编辑操作按钮，按下章节名称可拖动；<br>
                                    5、增加章节，自动增加到当前的下一项，随后的章节编号自动增加；<br>
                                    6、系统默认第一章第一节为面试试听课程。<br>
                                </p>
                            </div>
                            <div class="am-u-md-12">
                                <ul id="volumeTree" class="ztree"></ul>
                            </div>
                        </div>
                        <div class="am-u-lg-6 am-u-md-12">
                            <div>
                                <input type="text" id="ossDir" maxlength="80" style="display: inline-block; width: 70%;" placeholder="请输入视频所在OSS目录">
                                <input type="button" class="am-btn am-btn-default" style="width: 28%;" value="获取视频列表" ng-click="getOssList()"><br>
                                <p>视频格式支持：3GP、AVI、FLV、MP4、MPG、WMV、MKV、MOV</p>
                            </div>
                            <div class="am-panel am-panel-secondary">
                                <div class="am-panel-hd am-text-center">待处理列表</div>
                                <div class="am-panel-bd" style="max-height: 600px; overflow-y: scroll; overflow-x: hidden;">
                                    <ul class="am-list am-list-border" id="ossList">
                                        <li ng-repeat="o in ossDatas" ng-show="o.show">
                                            <a ng-mousedown="bindToTree($event, o)" data-name="{{o.name || (o.key | filename:true)}}" class="am-text-truncate ossItem">{{o.name || o.key}}
                                                <small>{{(o.size/1024).toFixed(2) | filesize}}</small>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="am-u-sm-12 am-margin-top">
                            <a class="am-btn am-btn-secondary am-btn-lg" ui-sref="volumeList()">返回列表</a>
                            <button type="button" class="am-btn am-btn-lg am-btn-primary" ng-click="save()" ng-disabled="volumeForm.$invalid">保存</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </form>
</div>
<div id="nodeForm">
    <p>
        <label for="nodeName">视频名称</label>
        <input type="text" id="nodeName">
    </p>
    <p>
        <label for="nodeName">文件路径</label>
        <input type="text" id="nodeUrl" disabled>
    </p>
    <p>
        <label for="nodeName">视频时长</label>
        <input type="number" max="999999" min="0" id="nodeDuration" required>
    </p>
    <p>
        <input type="checkbox" id="isFree" style="width: auto;margin: 0 10px 0 80px;">
        <label for="isFree">免费</label>
    </p>
</div>