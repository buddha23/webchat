<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lld360.cnc.repository.EnterpriseCertificationDao">
<insert id="insert" parameterType="com.lld360.cnc.model.EnterpriseCertification" useGeneratedKeys="true" keyProperty="id">
  INSERT INTO enterprise_certification 
  (user_id,name,address,registration_no,registration_img,link_man,mobile,state,create_time)
  VALUES
  (#{userId},#{name},#{address},#{registrationNo},#{registrationImg},#{linkman},#{mobile},#{state},current_timestamp)
</insert>

<select id="findByUserId" resultType="com.lld360.cnc.model.EnterpriseCertification" parameterType="long">
  SELECT
  id, 
  user_id userId,
  name,
  address,
  registration_no registrationNo,
  registration_img registrationImg,
  link_man linkman,
  mobile,
  state,
  create_time createTime,
  update_time updateTime
  FROM enterprise_certification
  WHERE user_id = #{userId}
</select>

<select id="get" parameterType="long" resultType="com.lld360.cnc.model.EnterpriseCertification">
  SELECT
  id, 
  user_id userId,
  name,
  address,
  registration_no registrationNo,
  registration_img registrationImg,
  link_man linkman,
  mobile,
  state,
  create_time createTime,
  update_time updateTime
  FROM enterprise_certification
  WHERE id = #{id}
</select>

<update id="update" parameterType="com.lld360.cnc.model.EnterpriseCertification">
  UPDATE enterprise_certification 
     <set>
            <if test="name != null">name = #{name},</if>
            <if test="address != null">address = #{address},</if>
            <if test="registrationNo != null">registration_no = #{registrationNo},</if>
            <if test="registrationImg != null">registration_img = #{registrationImg},</if>
            <if test="linkman != null">link_man = #{linkman},</if>
            <if test="mobile != null">mobile = #{mobile},</if>
            <if test="state != null">state = #{state},</if>
            update_time = current_timestamp 
        </set>
        WHERE id = #{id};
</update>

    <update id="updatePassInfo" parameterType="com.lld360.cnc.model.EnterpriseCertification">
       UPDATE enterprise_certification 
       <set>
            <if test="linkman != null">link_man = #{linkman},</if>
            <if test="mobile != null">mobile = #{mobile},</if>
            update_time = current_timestamp 
        </set>
        WHERE id = #{id};
    </update>
    


     <select id="search" parameterType="map" resultType="com.lld360.cnc.model.EnterpriseCertification">
        SELECT
        id,  
        user_id userId,
        name,
        address,
        registration_no registrationNo,
        registration_img registrationImg,
        link_man linkman,
        mobile,
        state,  
        create_time createTime,
        update_time updateTime
        FROM enterprise_certification
        <where>
          <if test="name !=null">AND name =#{name}</if>
          <if test="registrationNo != null">AND registration_no = #{registrationNo}</if>
        </where>
        <if test="limit != null">LIMIT #{limit}</if>
        <if test="offset != null">OFFSET #{offset}</if>
    </select>
    
    <select id="count" parameterType="map" resultType="long">
        SELECT count(1)
        FROM enterprise_certification
          <where>
          <if test="name !=null">AND name =#{name}</if>
          <if test="registrationNo != null">AND registration_no = #{registrationNo}</if>
        </where>
    </select>
</mapper>